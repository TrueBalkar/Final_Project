<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>auction.authorisation API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>auction.authorisation</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from auction.imports import flash, redirect, url_for, session, ConnectToDatabase, select_from_user_id, \
    delete_account_data
from auction import bcrypt


def check_logged_in() -&gt; None:
    &#34;&#34;&#34;
    Checks whether user is logged in.
    &#34;&#34;&#34;
    try:
        select_from_user_id(session[&#39;username&#39;])
    except:
        session[&#39;loggedin&#39;] = False


def login_required():
    &#34;&#34;&#34;
    If user is not logged in. This function will not let him to get access to any pages that require him
    to be logged in.

    :return: redirect user to login page.
    &#34;&#34;&#34;
    if session[&#39;loggedin&#39;] == False:
        logout()
    flash(&#34;You need to log in in order to get access to this page!&#34;, category=&#34;info&#34;)
    return redirect(url_for(&#34;login_page&#34;))


def logout() -&gt; None:
    &#34;&#34;&#34;
    Log out user!

    :return: Nothing.
    &#34;&#34;&#34;
    session[&#39;loggedin&#39;] = False
    flash(&#34;You have been logged out!&#34;, category=&#39;info&#39;)


def login(form):
    &#34;&#34;&#34;
    Login function. Login user and redirect them to home page.

    :param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
    :return: Login user and redirect him to home page.
    &#34;&#34;&#34;
    if form.validate_on_submit():
        &#34;&#34;&#34;
        Check if submit button was pressed.
        &#34;&#34;&#34;
        if check_registration_of_user(ConnectToDatabase.cursor, form.username.data, form.password.data):
            &#34;&#34;&#34;
            Check whether user was registered or not. If such user exist and password is correct, 
            login him and redirect to home page.
            &#34;&#34;&#34;
            session[&#39;loggedin&#39;] = True
            session[&#39;id&#39;] = select_from_user_id(form.username.data)
            session[&#39;username&#39;] = form.username.data
            flash(f&#39;You logged in successfully! Welcome {form.username.data}.&#39;, category=&#39;success&#39;)
            return redirect(url_for(&#39;auction_page&#39;))
        else:
            flash(&#39;Username and password do not match! Please try again!&#39;, category=&#39;danger&#39;)


def check_registration_of_user(cursor, login: str, password: str) -&gt; bool:
    &#34;&#34;&#34;
    Checks user login and password.

    :param cursor: Database cursor.
    :param login: User login.
    :param password: User password.
    :return: True if user and password correct. False otherwise.
    &#34;&#34;&#34;
    try:
        cursor.execute(f&#39;SELECT user_password FROM users WHERE login=&#34;{login}&#34;&#39;)
        buffer = cursor.fetchall()[0][0]
        if bcrypt.check_password_hash(buffer, password):
            return True
    except:
        return False


def register(form) -&gt; bool:
    &#34;&#34;&#34;
    Function used to register new user.

    :param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
    :return: Return True if all data is correct.
    &#34;&#34;&#34;
    if form.validate_on_submit():
        &#34;&#34;&#34;
        Check if submit button was pressed
        &#34;&#34;&#34;
        buffer = register_users(ConnectToDatabase.cursor,
                                ConnectToDatabase.db_connection,
                                str(form.username.data),
                                str(form.password1.data),
                                str(form.email_address.data))
        &#34;&#34;&#34;
        Check whether user with same data exist and return &#39;&#39; if there are no user with same username or email.
        If there is some data that is not unique to new user, it will be returned.
        &#34;&#34;&#34;
        if buffer == &#39;&#39;:
            flash(f&#39;Your account was successfully registered! &#39;
                  f&#39;You are now logged in as &#34;{form.username.data}&#34;.&#39;, category=&#39;success&#39;)
            session[&#39;loggedin&#39;] = True
            session[&#39;id&#39;] = select_from_user_id(form.username.data)
            session[&#39;username&#39;] = form.username.data
            return True
        elif buffer == str(form.username.data):
            &#34;&#34;&#34;
            Check if returned non unique data is username or email. Then corresponding message will be flashed.
            &#34;&#34;&#34;
            flash(f&#39;User with User Name: &#34;{form.username.data}&#34; already exist.&#39;, category=&#39;danger&#39;)
        else:
            flash(f&#39;User with Email Address: &#34;{form.email_address.data}&#34; already exist.&#39;, category=&#39;danger&#39;)
    if form.errors != {}:
        &#34;&#34;&#34;
        If there was some errors from form validation, it will be displayed in a nice message.
        &#34;&#34;&#34;
        for err_msg in form.errors.values():
            flash(f&#39;There was an error while creating a user: {err_msg}.&#39;, category=&#39;danger&#39;)


def register_users(cursor, conn, login: str, password: str, email: str) -&gt; str:
    &#34;&#34;&#34;
    Function that insert user data in database.

    :param cursor: Database cursor.
    :param conn: Database connection.
    :param login: User login.
    :param password: User password.
    :param email: User email
    :return: User login or email if it was already taken by someone else. Otherwise return &#39;&#39; ( empty string ).
    &#34;&#34;&#34;
    buffer = register_user_check(cursor, login, email)
    &#34;&#34;&#34;
    Check whether user with same data exist and return &#39;&#39; if there are no user with same username or email.
    If there is some data that is not unique to new user, it will be returned.
    &#34;&#34;&#34;
    if buffer == &#39;&#39;:
        password = bcrypt.generate_password_hash(password).decode(&#39;utf-8&#39;)
        &#34;&#34;&#34;
        Generating crypted password for maximum security!
        &#34;&#34;&#34;
        cursor.execute(&#34;SELECT MAX(id) FROM users&#34;)
        user_id = cursor.fetchall()[0][0]
        if user_id is None:
            &#34;&#34;&#34;
            Check whether it is a first user to be registered.
            &#34;&#34;&#34;
            user_id = 0
        user_id += 1
        if login == &#34;admin&#34;:
            privilegies = &#34;admin&#34;
        else:
            privilegies = &#34;member&#34;
        cursor.execute(f&#34;INSERT INTO users (id, login, user_password, &#34;
                       f&#34;email, budget, bidden_items, bidden_price, story, privilegies) &#34;
                       f&#34;VALUES ({user_id}, &#39;{login}&#39;, &#39;{password}&#39;, &#39;{email}&#39;, 0, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;{privilegies}&#39;)&#34;)
        conn.commit()
        &#34;&#34;&#34;
        Insert and commit changes in database.
        &#34;&#34;&#34;
        return buffer
    return buffer


def register_user_check(cursor, login: str, email: str) -&gt; str:
    &#34;&#34;&#34;
    Check if input user data was taken by somebody else already.

    :param cursor: Database cursor.
    :param login: User login.
    :param email: User email.
    :return: User login or email if it was already taken by someone else. Otherwise return &#39;&#39; ( empty string ).
    &#34;&#34;&#34;
    cursor.execute(f&#39;SELECT login FROM users WHERE login = &#34;{login}&#34;&#39;)
    &#34;&#34;&#34;
    Looking up for the same username in database.
    &#34;&#34;&#34;
    try:
        &#34;&#34;&#34;
        Check whether there is data from previous search. If there is None, it will return error which will be
        caught and redirected to the next search for identical email. Otherwise login shall be returned.
        &#34;&#34;&#34;
        buffer = cursor.fetchall()[0][0]
        return buffer
    except:
        cursor.execute(f&#39;SELECT email FROM users WHERE email = &#34;{email}&#34;&#39;)
        try:
            &#34;&#34;&#34;
            Check whether there is data from email search. If there is None, it will return error which will be
            caught and &#39;&#39; will be returned, which means that login and email are unique and may be used for 
            registration. Otherwise email shall be returned to show da wae.
            &#34;&#34;&#34;
            buffer = cursor.fetchall()[0][0]
            return buffer
        except:
            return &#39;&#39;


def delete_account(login: str):
    &#34;&#34;&#34;
    Delete user info from database and log him out.

    :param login: User login.
    :return: Log out and redirect to home page user whose account was deleted.
    &#34;&#34;&#34;
    if delete_account_data(login):
        &#34;&#34;&#34;
        Check if account with such username exist. If it doesn&#39;t display corresponding message and refresh the page.
        &#34;&#34;&#34;
        if login == session[&#39;username&#39;]:
            &#34;&#34;&#34;
            If it is the account of user who called this func he will be logged out, stripped of account and
            throwen to home page.
            &#34;&#34;&#34;
            logout()
            flash(f&#39;Your account was deleted!&#39;, category=&#34;danger&#34;)
            return redirect(url_for(&#34;home_page&#34;))
        else:
            &#34;&#34;&#34;
            Otherwise it will happen to other user.
            &#34;&#34;&#34;
            flash(f&#39;{login} account was successfully deleted!&#39;, category=&#34;success&#34;)
            return redirect(url_for(&#39;my_office_page&#39;))
    flash(f&#39;It seems {login} account doesn`t exist!&#39;, category=&#34;danger&#34;)
    return redirect(url_for(&#39;my_office_page&#39;))</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="auction.authorisation.check_logged_in"><code class="name flex">
<span>def <span class="ident">check_logged_in</span></span>(<span>) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Checks whether user is logged in.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_logged_in() -&gt; None:
    &#34;&#34;&#34;
    Checks whether user is logged in.
    &#34;&#34;&#34;
    try:
        select_from_user_id(session[&#39;username&#39;])
    except:
        session[&#39;loggedin&#39;] = False</code></pre>
</details>
</dd>
<dt id="auction.authorisation.check_registration_of_user"><code class="name flex">
<span>def <span class="ident">check_registration_of_user</span></span>(<span>cursor, login: str, password: str) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Checks user login and password.</p>
<p>:param cursor: Database cursor.
:param login: User login.
:param password: User password.
:return: True if user and password correct. False otherwise.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_registration_of_user(cursor, login: str, password: str) -&gt; bool:
    &#34;&#34;&#34;
    Checks user login and password.

    :param cursor: Database cursor.
    :param login: User login.
    :param password: User password.
    :return: True if user and password correct. False otherwise.
    &#34;&#34;&#34;
    try:
        cursor.execute(f&#39;SELECT user_password FROM users WHERE login=&#34;{login}&#34;&#39;)
        buffer = cursor.fetchall()[0][0]
        if bcrypt.check_password_hash(buffer, password):
            return True
    except:
        return False</code></pre>
</details>
</dd>
<dt id="auction.authorisation.delete_account"><code class="name flex">
<span>def <span class="ident">delete_account</span></span>(<span>login: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Delete user info from database and log him out.</p>
<p>:param login: User login.
:return: Log out and redirect to home page user whose account was deleted.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_account(login: str):
    &#34;&#34;&#34;
    Delete user info from database and log him out.

    :param login: User login.
    :return: Log out and redirect to home page user whose account was deleted.
    &#34;&#34;&#34;
    if delete_account_data(login):
        &#34;&#34;&#34;
        Check if account with such username exist. If it doesn&#39;t display corresponding message and refresh the page.
        &#34;&#34;&#34;
        if login == session[&#39;username&#39;]:
            &#34;&#34;&#34;
            If it is the account of user who called this func he will be logged out, stripped of account and
            throwen to home page.
            &#34;&#34;&#34;
            logout()
            flash(f&#39;Your account was deleted!&#39;, category=&#34;danger&#34;)
            return redirect(url_for(&#34;home_page&#34;))
        else:
            &#34;&#34;&#34;
            Otherwise it will happen to other user.
            &#34;&#34;&#34;
            flash(f&#39;{login} account was successfully deleted!&#39;, category=&#34;success&#34;)
            return redirect(url_for(&#39;my_office_page&#39;))
    flash(f&#39;It seems {login} account doesn`t exist!&#39;, category=&#34;danger&#34;)
    return redirect(url_for(&#39;my_office_page&#39;))</code></pre>
</details>
</dd>
<dt id="auction.authorisation.login"><code class="name flex">
<span>def <span class="ident">login</span></span>(<span>form)</span>
</code></dt>
<dd>
<div class="desc"><p>Login function. Login user and redirect them to home page.</p>
<p>:param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
:return: Login user and redirect him to home page.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def login(form):
    &#34;&#34;&#34;
    Login function. Login user and redirect them to home page.

    :param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
    :return: Login user and redirect him to home page.
    &#34;&#34;&#34;
    if form.validate_on_submit():
        &#34;&#34;&#34;
        Check if submit button was pressed.
        &#34;&#34;&#34;
        if check_registration_of_user(ConnectToDatabase.cursor, form.username.data, form.password.data):
            &#34;&#34;&#34;
            Check whether user was registered or not. If such user exist and password is correct, 
            login him and redirect to home page.
            &#34;&#34;&#34;
            session[&#39;loggedin&#39;] = True
            session[&#39;id&#39;] = select_from_user_id(form.username.data)
            session[&#39;username&#39;] = form.username.data
            flash(f&#39;You logged in successfully! Welcome {form.username.data}.&#39;, category=&#39;success&#39;)
            return redirect(url_for(&#39;auction_page&#39;))
        else:
            flash(&#39;Username and password do not match! Please try again!&#39;, category=&#39;danger&#39;)</code></pre>
</details>
</dd>
<dt id="auction.authorisation.login_required"><code class="name flex">
<span>def <span class="ident">login_required</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>If user is not logged in. This function will not let him to get access to any pages that require him
to be logged in.</p>
<p>:return: redirect user to login page.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def login_required():
    &#34;&#34;&#34;
    If user is not logged in. This function will not let him to get access to any pages that require him
    to be logged in.

    :return: redirect user to login page.
    &#34;&#34;&#34;
    if session[&#39;loggedin&#39;] == False:
        logout()
    flash(&#34;You need to log in in order to get access to this page!&#34;, category=&#34;info&#34;)
    return redirect(url_for(&#34;login_page&#34;))</code></pre>
</details>
</dd>
<dt id="auction.authorisation.logout"><code class="name flex">
<span>def <span class="ident">logout</span></span>(<span>) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Log out user!</p>
<p>:return: Nothing.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def logout() -&gt; None:
    &#34;&#34;&#34;
    Log out user!

    :return: Nothing.
    &#34;&#34;&#34;
    session[&#39;loggedin&#39;] = False
    flash(&#34;You have been logged out!&#34;, category=&#39;info&#39;)</code></pre>
</details>
</dd>
<dt id="auction.authorisation.register"><code class="name flex">
<span>def <span class="ident">register</span></span>(<span>form) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Function used to register new user.</p>
<p>:param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
:return: Return True if all data is correct.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def register(form) -&gt; bool:
    &#34;&#34;&#34;
    Function used to register new user.

    :param form: Inherited class from forms.py used to make beautiful and usable fields for getting data from user.
    :return: Return True if all data is correct.
    &#34;&#34;&#34;
    if form.validate_on_submit():
        &#34;&#34;&#34;
        Check if submit button was pressed
        &#34;&#34;&#34;
        buffer = register_users(ConnectToDatabase.cursor,
                                ConnectToDatabase.db_connection,
                                str(form.username.data),
                                str(form.password1.data),
                                str(form.email_address.data))
        &#34;&#34;&#34;
        Check whether user with same data exist and return &#39;&#39; if there are no user with same username or email.
        If there is some data that is not unique to new user, it will be returned.
        &#34;&#34;&#34;
        if buffer == &#39;&#39;:
            flash(f&#39;Your account was successfully registered! &#39;
                  f&#39;You are now logged in as &#34;{form.username.data}&#34;.&#39;, category=&#39;success&#39;)
            session[&#39;loggedin&#39;] = True
            session[&#39;id&#39;] = select_from_user_id(form.username.data)
            session[&#39;username&#39;] = form.username.data
            return True
        elif buffer == str(form.username.data):
            &#34;&#34;&#34;
            Check if returned non unique data is username or email. Then corresponding message will be flashed.
            &#34;&#34;&#34;
            flash(f&#39;User with User Name: &#34;{form.username.data}&#34; already exist.&#39;, category=&#39;danger&#39;)
        else:
            flash(f&#39;User with Email Address: &#34;{form.email_address.data}&#34; already exist.&#39;, category=&#39;danger&#39;)
    if form.errors != {}:
        &#34;&#34;&#34;
        If there was some errors from form validation, it will be displayed in a nice message.
        &#34;&#34;&#34;
        for err_msg in form.errors.values():
            flash(f&#39;There was an error while creating a user: {err_msg}.&#39;, category=&#39;danger&#39;)</code></pre>
</details>
</dd>
<dt id="auction.authorisation.register_user_check"><code class="name flex">
<span>def <span class="ident">register_user_check</span></span>(<span>cursor, login: str, email: str) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Check if input user data was taken by somebody else already.</p>
<p>:param cursor: Database cursor.
:param login: User login.
:param email: User email.
:return: User login or email if it was already taken by someone else. Otherwise return '' ( empty string ).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def register_user_check(cursor, login: str, email: str) -&gt; str:
    &#34;&#34;&#34;
    Check if input user data was taken by somebody else already.

    :param cursor: Database cursor.
    :param login: User login.
    :param email: User email.
    :return: User login or email if it was already taken by someone else. Otherwise return &#39;&#39; ( empty string ).
    &#34;&#34;&#34;
    cursor.execute(f&#39;SELECT login FROM users WHERE login = &#34;{login}&#34;&#39;)
    &#34;&#34;&#34;
    Looking up for the same username in database.
    &#34;&#34;&#34;
    try:
        &#34;&#34;&#34;
        Check whether there is data from previous search. If there is None, it will return error which will be
        caught and redirected to the next search for identical email. Otherwise login shall be returned.
        &#34;&#34;&#34;
        buffer = cursor.fetchall()[0][0]
        return buffer
    except:
        cursor.execute(f&#39;SELECT email FROM users WHERE email = &#34;{email}&#34;&#39;)
        try:
            &#34;&#34;&#34;
            Check whether there is data from email search. If there is None, it will return error which will be
            caught and &#39;&#39; will be returned, which means that login and email are unique and may be used for 
            registration. Otherwise email shall be returned to show da wae.
            &#34;&#34;&#34;
            buffer = cursor.fetchall()[0][0]
            return buffer
        except:
            return &#39;&#39;</code></pre>
</details>
</dd>
<dt id="auction.authorisation.register_users"><code class="name flex">
<span>def <span class="ident">register_users</span></span>(<span>cursor, conn, login: str, password: str, email: str) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Function that insert user data in database.</p>
<p>:param cursor: Database cursor.
:param conn: Database connection.
:param login: User login.
:param password: User password.
:param email: User email
:return: User login or email if it was already taken by someone else. Otherwise return '' ( empty string ).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def register_users(cursor, conn, login: str, password: str, email: str) -&gt; str:
    &#34;&#34;&#34;
    Function that insert user data in database.

    :param cursor: Database cursor.
    :param conn: Database connection.
    :param login: User login.
    :param password: User password.
    :param email: User email
    :return: User login or email if it was already taken by someone else. Otherwise return &#39;&#39; ( empty string ).
    &#34;&#34;&#34;
    buffer = register_user_check(cursor, login, email)
    &#34;&#34;&#34;
    Check whether user with same data exist and return &#39;&#39; if there are no user with same username or email.
    If there is some data that is not unique to new user, it will be returned.
    &#34;&#34;&#34;
    if buffer == &#39;&#39;:
        password = bcrypt.generate_password_hash(password).decode(&#39;utf-8&#39;)
        &#34;&#34;&#34;
        Generating crypted password for maximum security!
        &#34;&#34;&#34;
        cursor.execute(&#34;SELECT MAX(id) FROM users&#34;)
        user_id = cursor.fetchall()[0][0]
        if user_id is None:
            &#34;&#34;&#34;
            Check whether it is a first user to be registered.
            &#34;&#34;&#34;
            user_id = 0
        user_id += 1
        if login == &#34;admin&#34;:
            privilegies = &#34;admin&#34;
        else:
            privilegies = &#34;member&#34;
        cursor.execute(f&#34;INSERT INTO users (id, login, user_password, &#34;
                       f&#34;email, budget, bidden_items, bidden_price, story, privilegies) &#34;
                       f&#34;VALUES ({user_id}, &#39;{login}&#39;, &#39;{password}&#39;, &#39;{email}&#39;, 0, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;{privilegies}&#39;)&#34;)
        conn.commit()
        &#34;&#34;&#34;
        Insert and commit changes in database.
        &#34;&#34;&#34;
        return buffer
    return buffer</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="auction" href="index.html">auction</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="auction.authorisation.check_logged_in" href="#auction.authorisation.check_logged_in">check_logged_in</a></code></li>
<li><code><a title="auction.authorisation.check_registration_of_user" href="#auction.authorisation.check_registration_of_user">check_registration_of_user</a></code></li>
<li><code><a title="auction.authorisation.delete_account" href="#auction.authorisation.delete_account">delete_account</a></code></li>
<li><code><a title="auction.authorisation.login" href="#auction.authorisation.login">login</a></code></li>
<li><code><a title="auction.authorisation.login_required" href="#auction.authorisation.login_required">login_required</a></code></li>
<li><code><a title="auction.authorisation.logout" href="#auction.authorisation.logout">logout</a></code></li>
<li><code><a title="auction.authorisation.register" href="#auction.authorisation.register">register</a></code></li>
<li><code><a title="auction.authorisation.register_user_check" href="#auction.authorisation.register_user_check">register_user_check</a></code></li>
<li><code><a title="auction.authorisation.register_users" href="#auction.authorisation.register_users">register_users</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>